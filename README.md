# ğŸ˜ï¸ é•¿æ²™æ¥¼å¸‚æŸ¥è¯¢å¹³å° - åç«¯æœåŠ¡

<div align="center">

![Node Version](https://img.shields.io/badge/node-%3E%3D12.0.0-brightgreen)
![Koa Version](https://img.shields.io/badge/koa-2.7.0-orange)
![License](https://img.shields.io/badge/license-MIT-blue)
![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen)

ä¸€ä¸ªé«˜æ€§èƒ½ã€å…¨åŠŸèƒ½çš„æ¥¼ç›˜é”€å”®çŠ¶æ€æŸ¥è¯¢å¹³å°åç«¯æœåŠ¡

[åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§) â€¢
[æŠ€æœ¯æ¶æ„](#-æŠ€æœ¯æ¶æ„) â€¢
[å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹) â€¢
[APIæ–‡æ¡£](#-api-æ–‡æ¡£) â€¢
[éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—) â€¢
[ğŸ“‘ æ–‡æ¡£ç´¢å¼•](./PROJECT_INDEX.md)

</div>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

é•¿æ²™æ¥¼å¸‚æŸ¥è¯¢å¹³å°æ˜¯ä¸€ä¸ªé¢å‘Cç«¯ç”¨æˆ·çš„æˆ¿äº§ä¿¡æ¯æŸ¥è¯¢æœåŠ¡ï¼Œæ—¨åœ¨è§£å†³å®˜æ–¹æŸ¥è¯¢ç•Œé¢ä½“éªŒä¸ä½³ã€ç§»åŠ¨ç«¯é€‚é…å·®çš„ç—›ç‚¹ã€‚æœ¬é¡¹ç›®ä½œä¸ºåç«¯æ ¸å¿ƒæœåŠ¡ï¼Œæä¾›é«˜æ€§èƒ½çš„æ•°æ®æŸ¥è¯¢ã€å®æ—¶çˆ¬è™«åŒæ­¥ã€æ™ºèƒ½ç¼“å­˜ç­‰èƒ½åŠ›ï¼Œå¹¶æˆåŠŸæ¥å…¥å¾®ä¿¡å…¬ä¼—å·ï¼ŒæŒç»­ç¨³å®šè¿è¡Œè¿‘ä¸€å¹´ï¼ŒæœåŠ¡æ•°åƒç”¨æˆ·ã€‚

### ğŸ¯ è§£å†³çš„æ ¸å¿ƒé—®é¢˜

- âœ… **æŸ¥è¯¢æ•ˆç‡ä½**ï¼šé€šè¿‡Redisç¼“å­˜å’Œæ•°æ®åº“ç´¢å¼•ä¼˜åŒ–ï¼Œå°†æŸ¥è¯¢å“åº”æ—¶é—´ä»3ç§’é™è‡³200msä»¥å†…
- âœ… **ç§»åŠ¨ç«¯ä½“éªŒå·®**ï¼šæä¾›ç§»åŠ¨ç«¯å‹å¥½çš„RESTful APIï¼Œæ”¯æŒå‰ç«¯SPAåº”ç”¨
- âœ… **æ•°æ®æ›´æ–°æ…¢**ï¼šè‡ªç ”çˆ¬è™«å¼•æ“ï¼Œå®ç°ä½å»ºå±€å®˜ç½‘æ•°æ®çš„è‡ªåŠ¨åŒ–åŒæ­¥
- âœ… **æ— ç›‘æ§è¿ç»´**ï¼šé›†æˆELKç›‘æ§ä½“ç³»ï¼Œå®ç°æ—¥å¿—ã€å¼‚å¸¸ã€æ€§èƒ½å…¨æ–¹ä½ç›‘æ§

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **æ¥¼ç›˜ä¿¡æ¯æŸ¥è¯¢** - æ”¯æŒæŒ‰é¢„å”®è¯å·ã€æ¥¼ç›˜åç§°ç­‰å¤šç»´åº¦æŸ¥è¯¢
- ğŸ¢ **æ¥¼æ ‹è¯¦æƒ…æŸ¥è¯¢** - å±•ç¤ºæ¥¼æ ‹åŸºæœ¬ä¿¡æ¯ã€é”€å”®çŠ¶æ€ç­‰
- ğŸ  **æˆ¿æºçŠ¶æ€æŸ¥è¯¢** - å®æ—¶æŸ¥çœ‹æˆ¿æºé”€å”®/é¢„å”®çŠ¶æ€
- ğŸ“Š **æ•°æ®ç»Ÿè®¡åˆ†æ** - æ¥¼ç›˜é”€å”®è¿›åº¦ã€æˆ¿æºçŠ¶æ€åˆ†å¸ƒç­‰ç»Ÿè®¡

### æŠ€æœ¯ç‰¹æ€§

- âš¡ **é«˜æ€§èƒ½æŸ¥è¯¢** - Redisç¼“å­˜ + MySQLç´¢å¼•ä¼˜åŒ–ï¼ŒQPSå¯è¾¾1000+
- ğŸ•·ï¸ **æ™ºèƒ½çˆ¬è™«ç³»ç»Ÿ** - åŸºäºrequest-promise + cheerioçš„æ•°æ®é‡‡é›†å¼•æ“
- ğŸ“ˆ **å…¨é“¾è·¯ç›‘æ§** - é›†æˆElasticsearch + Kibanaï¼Œå®ç°æ—¥å¿—ã€å¼‚å¸¸ã€æ€§èƒ½ç›‘æ§
- ğŸ” **æ¥å£å®‰å…¨é˜²æŠ¤** - éªŒè¯ç éªŒè¯ã€è¯·æ±‚é¢‘ç‡é™åˆ¶ã€JWTé‰´æƒ
- ğŸš€ **ç”Ÿäº§çº§éƒ¨ç½²** - PM2é›†ç¾¤æ¨¡å¼ + Nginxåå‘ä»£ç†ï¼Œé«˜å¯ç”¨ä¿éšœ

---

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

**æ ¸å¿ƒæ¡†æ¶**
- [Koa 2.x](https://koajs.com/) - è½»é‡çº§Node.js Webæ¡†æ¶
- [Sequelize 5.x](https://sequelize.org/) - å¼ºå¤§çš„ORMæ¡†æ¶

**æ•°æ®å­˜å‚¨**
- [MySQL 5.7+](https://www.mysql.com/) - ä¸»æ•°æ®å­˜å‚¨
- [Redis 5.x](https://redis.io/) - ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- [Elasticsearch 7.x](https://www.elastic.co/) - æ—¥å¿—å­˜å‚¨å’Œå…¨æ–‡æ£€ç´¢

**æ•°æ®é‡‡é›†**
- [request-promise](https://github.com/request/request-promise) - HTTPè¯·æ±‚åº“
- [cheerio](https://cheerio.js.org/) - æœåŠ¡ç«¯jQueryå®ç°ï¼Œç”¨äºHTMLè§£æ

**ç›‘æ§è¿ç»´**
- [log4js](https://log4js-node.github.io/log4js-node/) - æ—¥å¿—ç®¡ç†
- [@yu1596882018/server-sdk](https://github.com/yu1596882018/monitorJS) - è‡ªç ”ç›‘æ§SDK
- [PM2](https://pm2.keymetrics.io/) - Node.jsè¿›ç¨‹ç®¡ç†å™¨

### æŠ€æœ¯é€‰å‹ç†ç”±

| æŠ€æœ¯ | ç‰ˆæœ¬ | é€‰å‹ç†ç”± |
|------|------|----------|
| Node.js | 12.x+ | å¼‚æ­¥éé˜»å¡I/Oï¼Œé€‚åˆé«˜å¹¶å‘åœºæ™¯ |
| Koa2 | 2.7.0 | è½»é‡çº§æ¡†æ¶ï¼Œä¸­é—´ä»¶æœºåˆ¶çµæ´»ï¼ŒåŸç”Ÿæ”¯æŒasync/await |
| Sequelize | 5.x | æˆç†Ÿçš„ORMæ¡†æ¶ï¼Œæ”¯æŒPromiseï¼Œé˜²SQLæ³¨å…¥ |
| MySQL | 5.7+ | å…³ç³»å‹æ•°æ®ï¼ŒACIDä¿è¯ï¼Œç´¢å¼•æ€§èƒ½ä¼˜ç§€ |
| Redis | 5.x | é«˜æ€§èƒ½ç¼“å­˜ï¼ˆ10ä¸‡+QPSï¼‰ï¼Œæ”¯æŒå¤šç§æ•°æ®ç»“æ„ |
| Elasticsearch | 7.x | å¼ºå¤§çš„å…¨æ–‡æ£€ç´¢å’Œæ—¥å¿—åˆ†æèƒ½åŠ› |

### æ•´ä½“ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å®¢æˆ·ç«¯å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Web æµè§ˆå™¨  â”‚  â”‚  ç§»åŠ¨ç«¯ APP  â”‚  â”‚  å¾®ä¿¡å…¬ä¼—å·  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ¥å…¥å±‚ (Nginx)                            â”‚
â”‚  â€¢ HTTPS åŠ å¯†            â€¢ åå‘ä»£ç†          â€¢ è´Ÿè½½å‡è¡¡          â”‚
â”‚  â€¢ é™æ€èµ„æºç¼“å­˜          â€¢ Gzip å‹ç¼©         â€¢ è¯·æ±‚é™æµ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨å±‚ (Koa2 Application)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     ä¸­é—´ä»¶æ ˆ                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚æ—¥å¿—ä¸­é—´ä»¶â”‚ â”‚CORSä¸­é—´ä»¶â”‚ â”‚å“åº”æ ¼å¼åŒ–â”‚ â”‚é”™è¯¯å¤„ç† â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      è·¯ç”±å±‚                                â”‚ â”‚
â”‚  â”‚  /api/houseInfoList     /api/houseChildren               â”‚ â”‚
â”‚  â”‚  /api/houseChildrenInfo /api/verifyCode                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     æ§åˆ¶å™¨å±‚                               â”‚ â”‚
â”‚  â”‚  â€¢ è¯·æ±‚å‚æ•°æ ¡éªŒ    â€¢ ä¸šåŠ¡é€»è¾‘å¤„ç†    â€¢ å“åº”æ•°æ®ç»„è£…       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     æ¨¡å‹å±‚ (Model)                         â”‚ â”‚
â”‚  â”‚  â€¢ æ•°æ®è®¿é—®é€»è¾‘    â€¢ ORM æ˜ å°„        â€¢ æ•°æ®éªŒè¯           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                    â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MySQL æ•°æ®åº“     â”‚ â”‚  Redis ç¼“å­˜å±‚    â”‚ â”‚  Elasticsearch  â”‚
â”‚  â€¢ æ¥¼ç›˜ä¿¡æ¯è¡¨      â”‚ â”‚  â€¢ çƒ­ç‚¹æ•°æ®ç¼“å­˜   â”‚ â”‚  â€¢ åº”ç”¨æ—¥å¿—      â”‚
â”‚  â€¢ æ¥¼æ ‹ä¿¡æ¯è¡¨      â”‚ â”‚  â€¢ Sessionå­˜å‚¨   â”‚ â”‚  â€¢ é”™è¯¯æ—¥å¿—      â”‚
â”‚  â€¢ æˆ¿æºä¿¡æ¯è¡¨      â”‚ â”‚  â€¢ éªŒè¯ç å­˜å‚¨    â”‚ â”‚  â€¢ è®¿é—®æ—¥å¿—      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æ•°æ®é‡‡é›†å±‚ (çˆ¬è™«)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  æ•°æ®æŠ“å–    â”‚  â”‚  æ•°æ®æ¸…æ´—    â”‚  â”‚  æ•°æ®å…¥åº“    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                 â”‚                 â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     ä½å»ºå±€å®˜ç½‘æ•°æ®æº

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç›‘æ§å±‚ (Monitoring)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   æ€§èƒ½ç›‘æ§    â”‚  â”‚   é”™è¯¯ç›‘æ§    â”‚  â”‚   ä¸šåŠ¡ç›‘æ§    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                      Kibana å¯è§†åŒ–                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒæ¨¡å—

```
src/
â”œâ”€â”€ app.js                  # Koaåº”ç”¨åˆå§‹åŒ–
â”œâ”€â”€ main.js                 # æœåŠ¡å¯åŠ¨å…¥å£
â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ index.js           # ä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ logConfig.js       # æ—¥å¿—é…ç½®
â”œâ”€â”€ controllers/           # æ§åˆ¶å™¨å±‚ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ queryHouseInfo.js # æŸ¥è¯¢æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ houseInfoList.js  # æ¥¼ç›˜ä¿¡æ¯
â”‚   â”œâ”€â”€ houseChildren.js  # æ¥¼æ ‹ä¿¡æ¯
â”‚   â””â”€â”€ ...
â”œâ”€â”€ models/                # æ•°æ®æ¨¡å‹å±‚ï¼ˆæ•°æ®è®¿é—®ï¼‰
â”œâ”€â”€ routers/               # è·¯ç”±å±‚ï¼ˆæ¥å£å®šä¹‰ï¼‰
â”œâ”€â”€ middlewares/           # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ responseFormatter.js  # ç»Ÿä¸€å“åº”æ ¼å¼
â”‚   â””â”€â”€ apiError.js           # é”™è¯¯å¤„ç†
â”œâ”€â”€ db/                    # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ mysql.js          # MySQLè¿æ¥æ± 
â”‚   â”œâ”€â”€ redis.js          # Rediså®¢æˆ·ç«¯
â”‚   â””â”€â”€ es.js             # Elasticsearchå®¢æˆ·ç«¯
â”œâ”€â”€ schema/                # Sequelizeæ•°æ®è¡¨ç»“æ„
â”œâ”€â”€ scripts/               # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ houseMain.js      # çˆ¬è™«ä¸»æµç¨‹
â”‚   â”œâ”€â”€ initEsIndex.js    # ESç´¢å¼•åˆå§‹åŒ–
â”‚   â””â”€â”€ ...
â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°åº“
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 12.0.0
- MySQL >= 5.7
- Redis >= 5.0
- Elasticsearch >= 7.0 (å¯é€‰ï¼Œç”¨äºæ—¥å¿—ç›‘æ§)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/yu1596882018/changshaHouse.git
cd changshaHouse
```

2. **å®‰è£…ä¾èµ–**

```bash
# ä½¿ç”¨ yarnï¼ˆæ¨èï¼‰
yarn install

# æˆ–ä½¿ç”¨ npm
npm install
```

3. **é…ç½®æ•°æ®åº“**

åˆ›å»ºMySQLæ•°æ®åº“ï¼š
```sql
CREATE DATABASE changsha_house CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

4. **ä¿®æ”¹é…ç½®æ–‡ä»¶**

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿å¹¶ä¿®æ”¹é…ç½®ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `src/config/index.js` é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼š
```javascript
mysqlConfig: [
  'changsha_house',  // æ•°æ®åº“å
  'root',            // ç”¨æˆ·å
  'your_password',   // å¯†ç 
  {
    host: 'localhost',
    dialect: 'mysql',
    port: 3306,
  }
]
```

5. **åˆå§‹åŒ–æ•°æ®è¡¨**

```bash
# æ•°æ®è¡¨ä¼šåœ¨é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»º
# å¦‚éœ€æ‰‹åŠ¨åˆå§‹åŒ–ESç´¢å¼•
node src/scripts/initEsIndex.js
```

6. **å¯åŠ¨æœåŠ¡**

```bash
# å¼€å‘ç¯å¢ƒ
yarn dev
# æˆ–
npm run dev

# ç”Ÿäº§ç¯å¢ƒ
yarn prod
# æˆ–
npm run prod
```

7. **éªŒè¯æœåŠ¡**

è®¿é—® `http://localhost:8899` æŸ¥çœ‹æœåŠ¡çŠ¶æ€

---

## ğŸ—ï¸ ç³»ç»Ÿè®¾è®¡

### æŠ€æœ¯æ¶æ„åˆ†å±‚

#### 1. å®¢æˆ·ç«¯å±‚
- Webæµè§ˆå™¨ï¼ˆPCç«¯ï¼‰
- ç§»åŠ¨ç«¯åº”ç”¨ï¼ˆVue + Vantï¼‰
- å¾®ä¿¡å…¬ä¼—å·

#### 2. æ¥å…¥å±‚ (Nginx)
- HTTPSåŠ å¯†ä¼ è¾“
- åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡
- é™æ€èµ„æºç¼“å­˜ï¼ˆ7å¤©ï¼‰
- Gzipå‹ç¼©
- è¯·æ±‚é™æµ

#### 3. åº”ç”¨å±‚ (Koa2)
- **ä¸­é—´ä»¶æ ˆ**ï¼šæ—¥å¿—ã€CORSã€å“åº”æ ¼å¼åŒ–ã€é”™è¯¯å¤„ç†
- **è·¯ç”±å±‚**ï¼šRESTfulæ¥å£è·¯ç”±å®šä¹‰
- **æ§åˆ¶å™¨å±‚**ï¼šä¸šåŠ¡é€»è¾‘å¤„ç†ã€å‚æ•°æ ¡éªŒ
- **æ¨¡å‹å±‚**ï¼šæ•°æ®è®¿é—®å°è£…ã€ORMæ˜ å°„

#### 4. æ•°æ®å±‚
- **MySQL**ï¼šæŒä¹…åŒ–å­˜å‚¨ï¼Œå…³ç³»æ•°æ®ç®¡ç†
- **Redis**ï¼šç¼“å­˜å’Œä¼šè¯ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½
- **Elasticsearch**ï¼šæ—¥å¿—å­˜å‚¨å’Œå…¨æ–‡æ£€ç´¢

#### 5. æ•°æ®é‡‡é›†å±‚
- **çˆ¬è™«å¼•æ“**ï¼šè‡ªåŠ¨é‡‡é›†ä½å»ºå±€æ•°æ®
- **æ•°æ®æ¸…æ´—**ï¼šæ•°æ®éªŒè¯å’Œæ ¼å¼åŒ–
- **æ•°æ®åŒæ­¥**ï¼šå¢é‡æ›´æ–°å’Œå»é‡

#### 6. ç›‘æ§å±‚
- **æ€§èƒ½ç›‘æ§**ï¼šå“åº”æ—¶é—´ã€QPSã€èµ„æºä½¿ç”¨
- **é”™è¯¯ç›‘æ§**ï¼šå¼‚å¸¸æ•è·å’Œè¿½è¸ª
- **ä¸šåŠ¡ç›‘æ§**ï¼šç”¨æˆ·è¡Œä¸ºã€çƒ­ç‚¹æ•°æ®

### æ•°æ®åº“è®¾è®¡

#### ER å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   house_info_list   â”‚ æ¥¼ç›˜ä¿¡æ¯è¡¨ï¼ˆä¸»è¡¨ï¼‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)             â”‚ æ¥¼ç›˜å”¯ä¸€æ ‡è¯†
â”‚ project_name        â”‚ æ¥¼ç›˜åç§°
â”‚ presell_license     â”‚ é¢„å”®è¯å·
â”‚ developer           â”‚ å¼€å‘å•†
â”‚ address             â”‚ æ¥¼ç›˜åœ°å€
â”‚ district            â”‚ æ‰€å±åŒºåŸŸ
â”‚ total_buildings     â”‚ æ¥¼æ ‹æ€»æ•°
â”‚ total_units         â”‚ æˆ¿æºæ€»æ•°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ 1:N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   house_children    â”‚ æ¥¼æ ‹ä¿¡æ¯è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ i (PK)              â”‚ æ¥¼æ ‹å”¯ä¸€æ ‡è¯†
â”‚ house_id (FK)       â”‚ æ‰€å±æ¥¼ç›˜ID
â”‚ building_name       â”‚ æ¥¼æ ‹åç§°
â”‚ total_floors        â”‚ æ€»æ¥¼å±‚æ•°
â”‚ total_units         â”‚ æ€»æˆ·æ•°
â”‚ sold_count          â”‚ å·²å”®æ•°é‡
â”‚ available_count     â”‚ å¯å”®æ•°é‡
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚ 1:N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ house_children_info     â”‚ æˆ¿æºä¿¡æ¯è¡¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id (PK)                 â”‚ ä¸»é”®ID
â”‚ building_id (FK)        â”‚ æ‰€å±æ¥¼æ ‹ID
â”‚ house_id (FK)           â”‚ æ‰€å±æ¥¼ç›˜ID
â”‚ unit_no                 â”‚ æˆ¿å·
â”‚ floor                   â”‚ æ¥¼å±‚
â”‚ area                    â”‚ å»ºç­‘é¢ç§¯
â”‚ status                  â”‚ é”€å”®çŠ¶æ€
â”‚ building_structure      â”‚ æˆ·å‹ç»“æ„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç´¢å¼•è®¾è®¡**ï¼š
- `idx_presell_license` - é¢„å”®è¯å·æŸ¥è¯¢ä¼˜åŒ–
- `idx_project_name` - æ¥¼ç›˜åç§°æœç´¢ä¼˜åŒ–
- `idx_house_id` - å…³è”æŸ¥è¯¢ä¼˜åŒ–
- `idx_status` - çŠ¶æ€ç­›é€‰ä¼˜åŒ–

### ä¸‰çº§ç¼“å­˜ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Nginx ç¼“å­˜å±‚ï¼ˆä¸€çº§ç¼“å­˜ï¼‰              â”‚
â”‚  â€¢ é™æ€èµ„æºï¼š7å¤©                                 â”‚
â”‚  â€¢ APIå“åº”ï¼š5åˆ†é’Ÿï¼ˆå¯é€‰ï¼‰                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Cache Miss
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Redis ç¼“å­˜å±‚ï¼ˆäºŒçº§ç¼“å­˜ï¼‰              â”‚
â”‚  â€¢ æ¥¼ç›˜ä¿¡æ¯ï¼š10åˆ†é’Ÿ                              â”‚
â”‚  â€¢ æ¥¼æ ‹åˆ—è¡¨ï¼š10åˆ†é’Ÿ                              â”‚
â”‚  â€¢ æˆ¿æºè¯¦æƒ…ï¼š5åˆ†é’Ÿ                               â”‚
â”‚  â€¢ ç»Ÿè®¡æ•°æ®ï¼š15åˆ†é’Ÿ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Cache Miss
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MySQL æ•°æ®åº“ï¼ˆä¸‰çº§ç¼“å­˜ï¼‰              â”‚
â”‚  â€¢ æŒä¹…åŒ–å­˜å‚¨                                    â”‚
â”‚  â€¢ ç´¢å¼•åŠ é€ŸæŸ¥è¯¢                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç¼“å­˜ç­–ç•¥**ï¼šCache Aside Patternï¼ˆæ—è·¯ç¼“å­˜ï¼‰
- æŸ¥è¯¢æ—¶å…ˆæŸ¥ç¼“å­˜ï¼Œæœªå‘½ä¸­å†æŸ¥æ•°æ®åº“
- æŸ¥è¯¢åå°†æ•°æ®å†™å…¥ç¼“å­˜
- æ›´æ–°æ—¶å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜

**ç¼“å­˜ä¼˜åŒ–**ï¼š
- âœ… ç¼“å­˜ç©¿é€é˜²æŠ¤ï¼ˆç©ºå€¼ç¼“å­˜ï¼‰
- âœ… ç¼“å­˜å‡»ç©¿é˜²æŠ¤ï¼ˆäº’æ–¥é”ï¼‰
- âœ… ç¼“å­˜é›ªå´©é˜²æŠ¤ï¼ˆéšæœºè¿‡æœŸæ—¶é—´ï¼‰

### çˆ¬è™«è®¾è®¡

#### çˆ¬è™«æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              çˆ¬è™«è°ƒåº¦å™¨                            â”‚
â”‚  â€¢ å®šæ—¶ä»»åŠ¡ (cron: 0 2 * * *)                    â”‚
â”‚  â€¢ ä»»åŠ¡é˜Ÿåˆ—                                       â”‚
â”‚  â€¢ å¹¶å‘æ§åˆ¶                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚            â”‚            â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
â”‚çˆ¬è™«å®ä¾‹1â”‚ â”‚çˆ¬è™«å®ä¾‹2â”‚ â”‚çˆ¬è™«å®ä¾‹N â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
    â”‚           â”‚            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   æ•°æ®å¤„ç†ç®¡é“          â”‚
    â”‚ 1. HTMLè§£æ            â”‚
    â”‚ 2. æ•°æ®æ¸…æ´—            â”‚
    â”‚ 3. æ•°æ®éªŒè¯            â”‚
    â”‚ 4. æ•°æ®å»é‡            â”‚
    â”‚ 5. æ•°æ®å…¥åº“            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ ¸å¿ƒæµç¨‹

```javascript
async function crawlHouse(houseId) {
  try {
    // Step 1: é‡‡é›†æ¥¼ç›˜åŸºæœ¬ä¿¡æ¯
    await crawlHouseInfo(houseId);
    
    // Step 2: é‡‡é›†æ¥¼æ ‹åˆ—è¡¨
    const buildings = await crawlBuildings(houseId);
    
    // Step 3: é‡‡é›†æ¯ä¸ªæ¥¼æ ‹çš„æˆ¿æºä¿¡æ¯
    for (const building of buildings) {
      await crawlUnits(houseId, building.id);
      await sleep(1000); // å»¶è¿Ÿ1ç§’ï¼Œé¿å…è¯·æ±‚è¿‡å¿«
    }
  } catch (error) {
    // é”™è¯¯é‡è¯•æœºåˆ¶
    await recordFailedTask(houseId);
  }
}
```

#### åçˆ¬è™«åº”å¯¹ç­–ç•¥

| åçˆ¬è™«æ‰‹æ®µ | åº”å¯¹ç­–ç•¥ |
|-----------|---------|
| éªŒè¯ç  | é›†æˆéªŒè¯ç è¯†åˆ«æœåŠ¡ |
| CookieéªŒè¯ | ç»´æŠ¤Cookieæ±  |
| è¯·æ±‚é¢‘ç‡é™åˆ¶ | è¯·æ±‚å»¶è¿Ÿ + ä»£ç†IP |
| User-Agentæ£€æµ‹ | éšæœºUser-Agent |
| IPå°ç¦ | ä»£ç†IPæ± è½®æ¢ |

### ç›‘æ§ä½“ç³»

#### ç›‘æ§æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              åº”ç”¨å±‚ç›‘æ§æ¢é’ˆ                        â”‚
â”‚  â€¢ @yu1596882018/server-sdk                      â”‚
â”‚  â€¢ è¯·æ±‚æ‹¦æˆª  â€¢ é”™è¯¯æ•è·  â€¢ æ€§èƒ½é‡‡é›†               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ ä¸ŠæŠ¥
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Elasticsearch å­˜å‚¨                     â”‚
â”‚  â€¢ ç´¢å¼•ï¼šchangsha_house_logs                     â”‚
â”‚  â€¢ æ—¥å¿—èšåˆ  â€¢ å…¨æ–‡æ£€ç´¢                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ æŸ¥è¯¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Kibana å¯è§†åŒ–                        â”‚
â”‚  â€¢ æ—¥å¿—æŸ¥è¯¢  â€¢ æ•°æ®å¤§ç›˜  â€¢ å‘Šè­¦è§„åˆ™               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç›‘æ§æŒ‡æ ‡

**æ€§èƒ½ç›‘æ§**

| æŒ‡æ ‡ | è¯´æ˜ | é˜ˆå€¼ |
|------|------|------|
| å“åº”æ—¶é—´ | APIå¹³å‡å“åº”æ—¶é—´ | < 200ms |
| QPS | æ¯ç§’è¯·æ±‚æ•° | > 100 |
| é”™è¯¯ç‡ | è¯·æ±‚å¤±è´¥æ¯”ä¾‹ | < 1% |
| CPUä½¿ç”¨ç‡ | æœåŠ¡å™¨CPU | < 80% |
| å†…å­˜ä½¿ç”¨ç‡ | æœåŠ¡å™¨å†…å­˜ | < 80% |

**ä¸šåŠ¡ç›‘æ§**
- æŸ¥è¯¢æ¬¡æ•°ç»Ÿè®¡
- çƒ­é—¨æ¥¼ç›˜Top10
- ç”¨æˆ·åœ°åŸŸåˆ†å¸ƒ
- æœç´¢åˆ°è¯¦æƒ…è½¬åŒ–ç‡

**é”™è¯¯ç›‘æ§**
- 5xxé”™è¯¯ç»Ÿè®¡
- æ•°æ®åº“è¿æ¥é”™è¯¯
- çˆ¬è™«å¤±è´¥æ¬¡æ•°
- ç¼“å­˜è¿æ¥å¼‚å¸¸

---

## ğŸ“¡ API æ–‡æ¡£

### åŸºç¡€ä¿¡æ¯

- **Base URL**: `http://localhost:8899`
- **å“åº”æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8

### é€šç”¨å“åº”æ ¼å¼

**æˆåŠŸå“åº”**
```json
{
  "success": true,
  "data": {
    // ä¸šåŠ¡æ•°æ®
  }
}
```

**é”™è¯¯å“åº”**
```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "é”™è¯¯æè¿°ä¿¡æ¯"
  }
}
```

### æ ¸å¿ƒæ¥å£

#### 1. è·å–éªŒè¯ç å›¾ç‰‡

```http
GET /api/getCodeImg
```

**å“åº”**: è¿”å›éªŒè¯ç å›¾ç‰‡ï¼ˆimage/pngï¼‰

---

#### 2. éªŒè¯é¢„å”®è¯å·å¹¶è·å–æ¥¼ç›˜ID

```http
POST /api/verifyCode
Content-Type: application/json

{
  "yszh": "é¢„å”®è¯å·",
  "verify_code": "éªŒè¯ç "
}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "status": "1",
  "id": "æ¥¼ç›˜å”¯ä¸€æ ‡è¯†",
  "content": "HTMLå†…å®¹"
}
```

---

#### 3. æŸ¥è¯¢æ¥¼ç›˜åŸºæœ¬ä¿¡æ¯

```http
GET /api/houseInfoList?id={æ¥¼ç›˜ID}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "id": "abc123",
    "name": "æŸæŸæ¥¼ç›˜",
    "address": "é•¿æ²™å¸‚XXåŒºXXè·¯XXå·",
    "developer": "å¼€å‘å•†åç§°",
    "presellLicense": "é¢„å”®è¯å·",
    "totalBuildings": 10,
    "totalUnits": 500
  }
}
```

---

#### 4. æŸ¥è¯¢æ¥¼æ ‹åˆ—è¡¨

```http
GET /api/houseChildren?id={æ¥¼ç›˜ID}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": [
    {
      "buildingId": "1",
      "buildingName": "1å·æ¥¼",
      "totalFloors": 32,
      "totalUnits": 128,
      "soldCount": 85,
      "availableCount": 43
    }
  ]
}
```

---

#### 5. æŸ¥è¯¢æˆ¿æºè¯¦ç»†ä¿¡æ¯

```http
GET /api/houseChildrenInfo?id={æ¥¼ç›˜ID}&buildingId={æ¥¼æ ‹ID}
```

**å“åº”ç¤ºä¾‹**
```json
{
  "success": true,
  "data": [
    {
      "unitNo": "1-101",
      "floor": 1,
      "area": 89.5,
      "status": "å·²å”®",
      "buildingStructure": "2å®¤2å…1å«"
    }
  ]
}
```

---

#### 6. é‡‡é›†æ¥¼ç›˜æ•°æ®ï¼ˆç®¡ç†æ¥å£ï¼‰

```http
GET /api/collectHouseInfo?id={æ¥¼ç›˜ID}
```

è§¦å‘çˆ¬è™«é‡‡é›†æŒ‡å®šæ¥¼ç›˜çš„å®Œæ•´æ•°æ®

---

å®Œæ•´APIæ–‡æ¡£è¯·æŸ¥çœ‹ï¼š[API_DOCUMENTATION.md](./docs/API_DOCUMENTATION.md)

---

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### 1. æœåŠ¡å™¨å‡†å¤‡

æ¨èé…ç½®ï¼š
- CPU: 2æ ¸+
- å†…å­˜: 4GB+
- ç³»ç»Ÿ: CentOS 7+ / Ubuntu 18.04+

#### 2. å®‰è£…è¿è¡Œç¯å¢ƒ

```bash
# å®‰è£… Node.js
curl -fsSL https://rpm.nodesource.com/setup_16.x | sudo bash -
sudo yum install -y nodejs

# å®‰è£… PM2
npm install -g pm2

# å®‰è£… MySQL
sudo yum install -y mysql-server

# å®‰è£… Redis
sudo yum install -y redis
```

#### 3. é…ç½® PM2

é¡¹ç›®å·²åŒ…å« `pm2.json` é…ç½®æ–‡ä»¶ï¼Œæ”¯æŒé›†ç¾¤æ¨¡å¼ï¼š

```bash
# å¯åŠ¨åº”ç”¨
pm2 start pm2.json

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs

# é‡å¯åº”ç”¨
pm2 restart app

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
pm2 save
```

#### 4. é…ç½® Nginx

```nginx
upstream changshahouse_backend {
    server 127.0.0.1:8899;
    keepalive 64;
}

server {
    listen 80;
    server_name your-domain.com;
    
    # å‰ç«¯é™æ€èµ„æº
    location / {
        root /var/www/changshahouse-frontend;
        try_files $uri $uri/ /index.html;
        
        # æµè§ˆå™¨ç¼“å­˜é…ç½®
        expires 7d;
        add_header Cache-Control "public, immutable";
    }
    
    # API æ¥å£ä»£ç†
    location /api {
        proxy_pass http://changshahouse_backend;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # ç¼“å­˜é…ç½®
        proxy_cache_bypass $http_upgrade;
        proxy_cache_valid 200 5m;
    }
}

# HTTPS é…ç½®ï¼ˆæ¨èï¼‰
server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    # ... åŒä¸Šé…ç½®
}
```

#### 5. é…ç½®é˜²ç«å¢™

```bash
# å¼€æ”¾å¿…è¦ç«¯å£
firewall-cmd --permanent --add-service=http
firewall-cmd --permanent --add-service=https
firewall-cmd --reload
```

#### 6. é…ç½®æ•°æ®åº“å®šæ—¶å¤‡ä»½

```bash
# æ·»åŠ åˆ° crontab
0 2 * * * /usr/bin/mysqldump -u root -p'password' changsha_house > /backup/db_$(date +\%Y\%m\%d).sql
```

è¯¦ç»†éƒ¨ç½²æ–‡æ¡£è¯·æŸ¥çœ‹ï¼š[DEPLOYMENT.md](./docs/DEPLOYMENT.md)

---

## ğŸ”§ å¼€å‘æŒ‡å—

### ç›®å½•ç»“æ„è¯´æ˜

- `src/controllers/` - ä¸šåŠ¡é€»è¾‘å¤„ç†
- `src/models/` - æ•°æ®åº“æ“ä½œå°è£…
- `src/routers/` - è·¯ç”±å®šä¹‰
- `src/middlewares/` - Koaä¸­é—´ä»¶
- `src/scripts/` - ç‹¬ç«‹è¿è¡Œçš„è„šæœ¬ï¼ˆçˆ¬è™«ã€åˆå§‹åŒ–ç­‰ï¼‰
- `src/utils/` - å·¥å…·å‡½æ•°

### æ·»åŠ æ–°æ¥å£

1. åœ¨ `src/controllers/` åˆ›å»ºæ§åˆ¶å™¨
2. åœ¨ `src/models/` åˆ›å»ºæ•°æ®æ¨¡å‹
3. åœ¨ `src/routers/` æ³¨å†Œè·¯ç”±
4. åœ¨ `src/schema/` å®šä¹‰æ•°æ®è¡¨ç»“æ„ï¼ˆå¦‚éœ€è¦ï¼‰

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ Prettier è¿›è¡Œä»£ç æ ¼å¼åŒ–ï¼š

```bash
# æ ¼å¼åŒ–ä»£ç 
yarn prettier
# æˆ–
npm run prettier
```

### æ—¥å¿—ç®¡ç†

åº”ç”¨æ—¥å¿—å­˜å‚¨åœ¨ `logs/` ç›®å½•ï¼š
- `app-out.log` - æ ‡å‡†è¾“å‡ºæ—¥å¿—
- `app-err.log` - é”™è¯¯æ—¥å¿—
- æ—¥å¿—æŒ‰å¤©åˆ†å‰²ï¼Œè‡ªåŠ¨æ¸…ç†30å¤©å‰çš„æ—¥å¿—

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

æœ¬é¡¹ç›®é‡‡ç”¨å¤šå±‚æ¬¡çš„æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ï¼Œå°†æŸ¥è¯¢å“åº”æ—¶é—´ä»3ç§’ä¼˜åŒ–åˆ°200mså†…ï¼Œæ€§èƒ½æå‡15å€ï¼š

### 1. æ•°æ®åº“ä¼˜åŒ–

**æŸ¥è¯¢ä¼˜åŒ–**
```sql
-- ä¼˜åŒ–å‰ï¼šå…¨è¡¨æ‰«æï¼ˆè€—æ—¶3ç§’+ï¼‰
SELECT * FROM house_info_list WHERE project_name LIKE '%èŠ±å›­%';

-- ä¼˜åŒ–åï¼šä½¿ç”¨å…¨æ–‡ç´¢å¼•ï¼ˆè€—æ—¶<100msï¼‰
ALTER TABLE house_info_list ADD FULLTEXT INDEX ft_name (project_name);
SELECT * FROM house_info_list WHERE MATCH(project_name) AGAINST('èŠ±å›­');
```

**å…¶ä»–ä¼˜åŒ–**ï¼š
- âœ… åˆç†ä½¿ç”¨ç´¢å¼•ï¼ˆé¢„å”®è¯å·ã€æ¥¼ç›˜åç§°ç­‰å­—æ®µï¼‰
- âœ… ä½¿ç”¨è¿æ¥æ± ç®¡ç†æ•°æ®åº“è¿æ¥ï¼ˆæœ€å¤§10ä¸ªè¿æ¥ï¼‰
- âœ… æŸ¥è¯¢ç»“æœåˆ†é¡µï¼Œé¿å…å¤§æ•°æ®é‡æŸ¥è¯¢
- âœ… é¿å…SELECT *ï¼ŒåªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ

**è¿æ¥æ± é…ç½®**
```javascript
pool: {
  max: 10,        // æœ€å¤§è¿æ¥æ•°
  min: 2,         // æœ€å°è¿æ¥æ•°
  acquire: 30000, // è·å–è¿æ¥è¶…æ—¶
  idle: 10000     // è¿æ¥ç©ºé—²æ—¶é—´
}
```

### 2. ç¼“å­˜ç­–ç•¥

**ä¸‰çº§ç¼“å­˜æ¶æ„**
- **Nginxç¼“å­˜ï¼ˆä¸€çº§ï¼‰**ï¼šé™æ€èµ„æº7å¤©ï¼Œéƒ¨åˆ†APIå“åº”5åˆ†é’Ÿ
- **Redisç¼“å­˜ï¼ˆäºŒçº§ï¼‰**ï¼šçƒ­ç‚¹æ•°æ®10åˆ†é’Ÿï¼Œå“åº”æ—¶é—´<10ms
- **MySQLæ•°æ®åº“ï¼ˆä¸‰çº§ï¼‰**ï¼šæŒä¹…åŒ–å­˜å‚¨ï¼Œç´¢å¼•åŠ é€Ÿ

**ç¼“å­˜é”®è®¾è®¡**
```javascript
const CACHE_KEYS = {
  HOUSE_INFO: (id) => `house:info:${id}`,
  BUILDING_LIST: (id) => `house:buildings:${id}`,
  UNIT_INFO: (houseId, buildingId) => `house:units:${houseId}:${buildingId}`
}
```

**ç¼“å­˜æ›´æ–°ç­–ç•¥**
```javascript
// Cache Aside Patternï¼ˆæ—è·¯ç¼“å­˜ï¼‰
async function getData(id) {
  // 1. æŸ¥è¯¢ç¼“å­˜
  let data = await redis.get(CACHE_KEYS.HOUSE_INFO(id));
  if (data) return JSON.parse(data);
  
  // 2. ç¼“å­˜æœªå‘½ä¸­ï¼ŒæŸ¥è¯¢æ•°æ®åº“
  data = await db.HouseInfo.findByPk(id);
  
  // 3. å†™å…¥ç¼“å­˜
  await redis.set(CACHE_KEYS.HOUSE_INFO(id), JSON.stringify(data), 'EX', 600);
  
  return data;
}
```

**ç¼“å­˜é˜²æŠ¤æœºåˆ¶**ï¼š
- âœ… ç¼“å­˜ç©¿é€é˜²æŠ¤ï¼ˆç©ºå€¼ç¼“å­˜ï¼‰
- âœ… ç¼“å­˜å‡»ç©¿é˜²æŠ¤ï¼ˆäº’æ–¥é”ï¼‰
- âœ… ç¼“å­˜é›ªå´©é˜²æŠ¤ï¼ˆéšæœºè¿‡æœŸæ—¶é—´ï¼‰

### 3. åº”ç”¨å±‚ä¼˜åŒ–

**å¼‚æ­¥å¹¶å‘æŸ¥è¯¢**
```javascript
// ä¼˜åŒ–å‰ï¼šä¸²è¡ŒæŸ¥è¯¢ï¼ˆè€—æ—¶300msï¼‰
const house = await getHouse(id);
const buildings = await getBuildings(id);
const stats = await getStats(id);

// ä¼˜åŒ–åï¼šå¹¶å‘æŸ¥è¯¢ï¼ˆè€—æ—¶100msï¼‰
const [house, buildings, stats] = await Promise.all([
  getHouse(id),
  getBuildings(id),
  getStats(id)
]);
```

**æ•°æ®åˆ†é¡µ**
```javascript
// é¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®
async function getUnits(buildingId, page = 1, pageSize = 20) {
  const offset = (page - 1) * pageSize;
  return await db.Units.findAndCountAll({
    where: { building_id: buildingId },
    limit: pageSize,
    offset: offset
  });
}
```

### 4. é›†ç¾¤éƒ¨ç½²
- âœ… PM2é›†ç¾¤æ¨¡å¼ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPUï¼ˆinstances: -1ï¼‰
- âœ… è¿›ç¨‹è‡ªåŠ¨é‡å¯ï¼Œä¿è¯æœåŠ¡å¯ç”¨æ€§
- âœ… å†…å­˜é™åˆ¶200MBï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
- âœ… è´Ÿè½½å‡è¡¡ï¼Œè¯·æ±‚å‡åŒ€åˆ†é…

### 5. ç›‘æ§å‘Šè­¦
- âœ… å®æ—¶æ€§èƒ½ç›‘æ§ï¼ˆå“åº”æ—¶é—´ã€QPSç­‰ï¼‰
- âœ… é”™è¯¯å¼‚å¸¸è¿½è¸ªå’Œå‘Šè­¦
- âœ… èµ„æºä½¿ç”¨ç›‘æ§ï¼ˆCPUã€å†…å­˜ï¼‰
- âœ… æ—¥å¿—èšåˆåˆ†æï¼ˆElasticsearch + Kibanaï¼‰

**æ€§èƒ½æå‡æ•ˆæœ**ï¼š

| åœºæ™¯ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| æŸ¥è¯¢å“åº”æ—¶é—´ | 2-3s | 100-200ms | **15å€** |
| QPS | 10 | 1000+ | **100å€** |
| é”™è¯¯ç‡ | 5% | <1% | **é™ä½80%** |

---

## ğŸ” å®‰å…¨æ€§

### å·²å®ç°çš„å®‰å…¨æªæ–½

#### 1. æ¥å£å®‰å…¨

**è¯·æ±‚é¢‘ç‡é™åˆ¶**
```javascript
// é˜²æ­¢æ¥å£æ»¥ç”¨
app.use(rateLimit({
  driver: 'redis',
  duration: 60000,  // 1åˆ†é’Ÿ
  max: 100,         // æœ€å¤š100æ¬¡è¯·æ±‚
  errorMessage: 'è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•'
}));
```

**å‚æ•°æ ¡éªŒ**
- âœ… ä¸¥æ ¼çš„å‚æ•°ç±»å‹æ£€æŸ¥
- âœ… å‚æ•°èŒƒå›´éªŒè¯
- âœ… æ¶æ„å‚æ•°è¿‡æ»¤

**å…¶ä»–å®‰å…¨æªæ–½**ï¼š
- âœ… **éªŒè¯ç é˜²æŠ¤** - é˜²æ­¢æ¶æ„çˆ¬è™«å’Œæš´åŠ›ç ´è§£
- âœ… **CORSè·¨åŸŸæ§åˆ¶** - é™åˆ¶æ¥å£è®¿é—®æ¥æº
- âœ… **SQLæ³¨å…¥é˜²æŠ¤** - ä½¿ç”¨Sequelize ORMå‚æ•°åŒ–æŸ¥è¯¢
- âœ… **XSSé˜²æŠ¤** - è¾“å…¥è¾“å‡ºè¿‡æ»¤å’ŒHTMLè½¬ä¹‰
- âœ… **HTTPSæ”¯æŒ** - æ•°æ®ä¼ è¾“åŠ å¯†ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

#### 2. æ•°æ®å®‰å…¨

- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆbcryptjsï¼‰
- âœ… JWT Tokené‰´æƒ
- âœ… Cookieè®¾ç½®HttpOnly
- âœ… å®šæœŸæ•°æ®åº“å¤‡ä»½

#### 3. ç³»ç»Ÿå®‰å…¨

- âœ… é˜²ç«å¢™é…ç½®
- âœ… SSHå¯†é’¥ç™»å½•
- âœ… ç¦ç”¨rootè¿œç¨‹ç™»å½•
- âœ… å®šæœŸå®‰å…¨æ›´æ–°

---

## ğŸ¯ é¡¹ç›®äº®ç‚¹

### æŠ€æœ¯äº®ç‚¹

#### 1. è‡ªç ”ç›‘æ§SDK â­â­â­â­â­
- ç‹¬ç«‹å¼€å‘ `@yu1596882018/server-sdk` ç›‘æ§ç»„ä»¶
- é›†æˆæ—¥å¿—ã€å¼‚å¸¸ã€æ€§èƒ½ç›‘æ§èƒ½åŠ›
- ä¸Elasticsearchæ— ç¼é›†æˆ
- æ”¯æŒè‡ªå®šä¹‰åŸ‹ç‚¹å’Œä¸šåŠ¡ç›‘æ§

#### 2. ä¸‰å±‚ç¼“å­˜æ¶æ„ â­â­â­â­â­
- Nginx + Redis + MySQL ä¸‰çº§ç¼“å­˜
- æ€§èƒ½æå‡15å€ï¼ˆ3ç§’ â†’ 200msï¼‰
- å®Œå–„çš„ç¼“å­˜é˜²æŠ¤æœºåˆ¶ï¼ˆç©¿é€/å‡»ç©¿/é›ªå´©ï¼‰
- Cache Aside Pattern æœ€ä½³å®è·µ

#### 3. æ™ºèƒ½çˆ¬è™«å¼•æ“ â­â­â­â­â­
- æ”¯æŒéªŒè¯ç è‡ªåŠ¨è¯†åˆ«
- è¯·æ±‚é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š3æ¬¡ï¼‰
- æ•°æ®å¢é‡æ›´æ–°å’Œå»é‡
- Cookieæ± å’Œä»£ç†IPç®¡ç†
- æ•°æ®åŒæ­¥æˆåŠŸç‡ 99%+

#### 4. å…¨é“¾è·¯ç›‘æ§ â­â­â­â­â­
- ELKæŠ€æœ¯æ ˆï¼ˆElasticsearch + Logstash + Kibanaï¼‰
- å››ç±»æ—¥å¿—åˆ†ç¦»ï¼ˆé”™è¯¯ã€å“åº”ã€MySQLã€è°ƒè¯•ï¼‰
- ä»è¯·æ±‚åˆ°æ•°æ®åº“çš„å…¨é“¾è·¯è¿½è¸ª
- å®æ—¶å‘Šè­¦å’Œå¯è§†åŒ–åˆ†æ

#### 5. PM2é›†ç¾¤éƒ¨ç½² â­â­â­â­â­
- é›†ç¾¤æ¨¡å¼ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- è‡ªåŠ¨é‡å¯å’Œè´Ÿè½½å‡è¡¡
- å†…å­˜ç›‘æ§å’Œé™åˆ¶
- 0ç§’åœæœºçƒ­é‡è½½

### ä¸šåŠ¡äº®ç‚¹

#### 1. æ€§èƒ½å“è¶Š
- æŸ¥è¯¢å“åº”æ—¶é—´ï¼š3ç§’ â†’ 200msï¼ˆ**æå‡15å€**ï¼‰
- æ”¯æŒQPSï¼š10 â†’ 1000+ï¼ˆ**æå‡100å€**ï¼‰
- é”™è¯¯ç‡é™ä½ï¼š5% â†’ <1%ï¼ˆ**é™ä½80%**ï¼‰

#### 2. ç”Ÿäº§éªŒè¯
- âœ… çœŸå®çº¿ä¸Šè¿è¡Œè¿‘ä¸€å¹´
- âœ… æ—¥æ´»ç”¨æˆ· 1000+
- âœ… æ—¥å‡è¯·æ±‚ 10ä¸‡+
- âœ… ç³»ç»Ÿå¯ç”¨æ€§ 99.9%+
- âœ… é›¶é‡å¤§ç”Ÿäº§äº‹æ•…

#### 3. ç”¨æˆ·ä½“éªŒ
- âœ… ç§»åŠ¨ç«¯å‹å¥½çš„RESTful API
- âœ… æ”¯æŒå¾®ä¿¡å…¬ä¼—å·é›†æˆ
- âœ… æ•°æ®å®æ—¶åŒæ­¥æ›´æ–°
- âœ… æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œä½“éªŒæµç•…

#### 4. å·¥ç¨‹åŒ–èƒ½åŠ›
- âœ… å®Œæ•´çš„æ–‡æ¡£ä½“ç³»
- âœ… è§„èŒƒçš„ä»£ç æ³¨é‡Š
- âœ… ç»Ÿä¸€çš„ä»£ç é£æ ¼
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… å…¨é¢çš„æ—¥å¿—ç®¡ç†

### æ ¸å¿ƒæ•°æ®

| æŒ‡æ ‡ | æ•°æ® |
|------|------|
| ä»£ç è¡Œæ•° | 5000+ |
| æ¥å£æ•°é‡ | 10+ |
| æ•°æ®è¡¨ | 4å¼  |
| æ—¥æ´»ç”¨æˆ· | 1000+ |
| æ—¥å‡è¯·æ±‚ | 10ä¸‡+ |
| ç³»ç»Ÿå¯ç”¨æ€§ | 99.9%+ |
| å¹³å‡å“åº”æ—¶é—´ | <200ms |
| å³°å€¼QPS | 1000+ |
| è¿è¡Œæ—¶é•¿ | è¿‘1å¹´ |

---

## ğŸ›¡ï¸ æ ¸å¿ƒæŠ€æœ¯éš¾ç‚¹ä¸è§£å†³æ–¹æ¡ˆ

### 1. é«˜å¹¶å‘æŸ¥è¯¢ä¼˜åŒ–

**æŒ‘æˆ˜**ï¼šåˆæœŸå“åº”æ—¶é—´3ç§’ï¼Œç”¨æˆ·ä½“éªŒå·®

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä¸‰çº§ç¼“å­˜æ¶æ„ï¼ˆNginx + Redis + MySQLï¼‰
- æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- è¿æ¥æ± ç®¡ç†
- PM2é›†ç¾¤éƒ¨ç½²

**æ•ˆæœ**ï¼šå“åº”æ—¶é—´é™è‡³200msï¼Œæå‡15å€

---

### 2. åçˆ¬è™«åº”å¯¹

**æŒ‘æˆ˜**ï¼šéªŒè¯ç ã€CookieéªŒè¯ã€è¯·æ±‚é¢‘ç‡é™åˆ¶

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é›†æˆéªŒè¯ç è¯†åˆ«æœåŠ¡
- ç»´æŠ¤Cookieæ± 
- è¯·æ±‚å»¶è¿Ÿï¼ˆ1ç§’/æ¬¡ï¼‰
- éšæœºUser-Agent
- ä»£ç†IPæ± è½®æ¢

**æ•ˆæœ**ï¼šæ•°æ®åŒæ­¥æˆåŠŸç‡99%+

---

### 3. æ•°æ®ä¸€è‡´æ€§

**æŒ‘æˆ˜**ï¼šç¼“å­˜å’Œæ•°æ®åº“æ•°æ®ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆ**ï¼š
- Cache Asideæ¨¡å¼
- æ›´æ–°æ—¶åˆ é™¤ç¼“å­˜
- åˆç†çš„è¿‡æœŸæ—¶é—´
- ç©ºå€¼ç¼“å­˜é˜²ç©¿é€

**æ•ˆæœ**ï¼šæ•°æ®ä¸€è‡´æ€§99.9%+

---

### 4. ç³»ç»Ÿç›‘æ§

**æŒ‘æˆ˜**ï¼šæ— æ³•åŠæ—¶å‘ç°å’Œå®šä½é—®é¢˜

**è§£å†³æ–¹æ¡ˆ**ï¼š
- é›†æˆElasticsearchå­˜å‚¨æ—¥å¿—
- Kibanaå¯è§†åŒ–åˆ†æ
- è‡ªç ”ç›‘æ§SDK
- å››ç±»æ—¥å¿—åˆ†ç¦»
- å…¨é“¾è·¯æ—¥å¿—è¿½è¸ª

**æ•ˆæœ**ï¼šé—®é¢˜å®šä½æ—¶é—´ä»å°æ—¶çº§é™è‡³åˆ†é’Ÿçº§

---

## ğŸ“ æ›´æ–°æ—¥å¿—

æŸ¥çœ‹å®Œæ•´æ›´æ–°è®°å½•ï¼š[CHANGELOG.md](./CHANGELOG.md)

### v1.0.0 (2021-02-15)

**åˆå§‹ç‰ˆæœ¬å‘å¸ƒ**
- âœ¨ å®ç°æ¥¼ç›˜ä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½
- âœ¨ å®ç°æ•°æ®çˆ¬è™«åŒæ­¥åŠŸèƒ½
- âœ¨ é›†æˆ MySQL + Redis + Elasticsearch
- âœ¨ æ¥å…¥å¾®ä¿¡å…¬ä¼—å·
- âœ¨ PM2 é›†ç¾¤éƒ¨ç½²

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### æäº¤è§„èŒƒ

- feat: æ–°åŠŸèƒ½
- fix: ä¿®å¤bug
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼è°ƒæ•´
- refactor: é‡æ„
- perf: æ€§èƒ½ä¼˜åŒ–
- test: æµ‹è¯•ç›¸å…³
- chore: æ„å»º/å·¥å…·é“¾ç›¸å…³

---

## ğŸ“„ License

æœ¬é¡¹ç›®åŸºäº [MIT License](./LICENSE) å¼€æº

---

## ğŸ‘¨â€ğŸ’» ä½œè€…

**ä½™å·¥** - [yu1596882018](https://github.com/yu1596882018)

- ğŸ“§ Email: 1596882018@qq.com
- ğŸ”— GitHub: [@yu1596882018](https://github.com/yu1596882018)

---

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢é•¿æ²™å¸‚ä½å»ºå±€æä¾›çš„æ•°æ®æº
- æ„Ÿè°¢æ‰€æœ‰ä½¿ç”¨è¿‡æœ¬é¡¹ç›®çš„ç”¨æˆ·

---

## ğŸ“š ç›¸å…³é“¾æ¥

- **å‰ç«¯é¡¹ç›®**: [changshaHouseMoblie](https://github.com/yu1596882018/changshaHouseMoblie)
- **ç›‘æ§SDK**: [@yu1596882018/server-sdk](https://github.com/yu1596882018/monitorJS)
- **æ¶æ„è¯¦ç»†æ–‡æ¡£**: [ARCHITECTURE.md](./docs/ARCHITECTURE.md)

---

## ğŸ“ æŠ€æœ¯æ”¶è·

### å…¨æ ˆå¼€å‘èƒ½åŠ›
- âœ… ç‹¬ç«‹å®Œæˆå‰åç«¯å¼€å‘
- âœ… æŒæ¡å®Œæ•´çš„é¡¹ç›®å¼€å‘æµç¨‹
- âœ… Vue + Vant ç§»åŠ¨ç«¯å¼€å‘
- âœ… Koa2 + MySQL åç«¯å¼€å‘

### ç³»ç»Ÿæ¶æ„è®¾è®¡
- âœ… åˆ†å±‚æ¶æ„è®¾è®¡ï¼ˆMVCæ¨¡å¼ï¼‰
- âœ… ä¸‰çº§ç¼“å­˜ç­–ç•¥è®¾è®¡
- âœ… ç›‘æ§ä½“ç³»è®¾è®¡
- âœ… é«˜å¯ç”¨æ¶æ„è®¾è®¡

### æ€§èƒ½ä¼˜åŒ–
- âœ… æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- âœ… ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
- âœ… ä»£ç æ€§èƒ½ä¼˜åŒ–
- âœ… å“åº”æ—¶é—´æå‡15å€

### è¿ç»´éƒ¨ç½²
- âœ… LinuxæœåŠ¡å™¨ç®¡ç†
- âœ… Nginxåå‘ä»£ç†é…ç½®
- âœ… PM2è¿›ç¨‹ç®¡ç†
- âœ… æ•°æ®åº“å¤‡ä»½å’Œæ¢å¤
- âœ… æ—¥å¿—åˆ†æå’Œé—®é¢˜æ’æŸ¥

### å·¥ç¨‹åŒ–å®è·µ
- âœ… ä»£ç è§„èŒƒå’Œé£æ ¼ç»Ÿä¸€
- âœ… å®Œæ•´çš„æ–‡æ¡£ä½“ç³»
- âœ… Gitç‰ˆæœ¬æ§åˆ¶
- âœ… æ¨¡å—åŒ–è®¾è®¡
- âœ… é”™è¯¯å¤„ç†æœºåˆ¶

---

## ğŸŒŸ é¡¹ç›®æ€»ç»“

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª**çœŸå®çš„ç”Ÿäº§çº§å…¨æ ˆé¡¹ç›®**ï¼Œå†æ—¶2ä¸ªæœˆå¼€å‘ï¼ŒæŒç»­è¿è¡Œè¿‘ä¸€å¹´ã€‚é¡¹ç›®ä»0åˆ°1ç‹¬ç«‹å®Œæˆï¼Œæ¶µç›–äº†éœ€æ±‚åˆ†æã€æ¶æ„è®¾è®¡ã€ä»£ç å®ç°ã€æµ‹è¯•éƒ¨ç½²ã€è¿ç»´ç›‘æ§çš„å®Œæ•´æµç¨‹ã€‚

**æ ¸å¿ƒæˆå°±**ï¼š
- ğŸ¯ è§£å†³äº†å®é™…ç”¨æˆ·ç—›ç‚¹
- ğŸ¯ å®ç°äº†15å€æ€§èƒ½æå‡
- ğŸ¯ æœåŠ¡äº†æ•°åƒåçœŸå®ç”¨æˆ·
- ğŸ¯ ç§¯ç´¯äº†ä¸°å¯Œçš„å…¨æ ˆå¼€å‘ç»éªŒ
- ğŸ¯ æŒæ¡äº†ç”Ÿäº§ç¯å¢ƒè¿ç»´èƒ½åŠ›

**æŠ€æœ¯ä»·å€¼**ï¼š
- ğŸ’¡ è‡ªç ”ç›‘æ§SDKï¼Œå¯å¤ç”¨çš„æŠ€æœ¯ç»„ä»¶
- ğŸ’¡ ä¸‰å±‚ç¼“å­˜æ¶æ„ï¼Œå¯å€Ÿé‰´çš„è®¾è®¡æ¨¡å¼
- ğŸ’¡ æ™ºèƒ½çˆ¬è™«å¼•æ“ï¼Œé€šç”¨çš„æ•°æ®é‡‡é›†æ–¹æ¡ˆ
- ğŸ’¡ å…¨é“¾è·¯ç›‘æ§ï¼Œå®Œæ•´çš„å¯è§‚æµ‹æ€§å®è·µ

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ Star â­**

Made with â¤ï¸ by [yu1596882018](https://github.com/yu1596882018)

</div>
